<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Pragma" content="no-cache">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

		<link rel="stylesheet" href="font/fontawesome/import.css">
		<link rel="stylesheet" href="font/ubuntu/import.css">

		<link rel="stylesheet" href="css/com.css">
		<link rel="stylesheet" href="css/reg.css">
	</head>
	
	<body>
		<div id="reg-main">
			<div id="reg-board" class="vcenter">
				<div id="reg-tbar">
					<span id="reg-title" class="vcenter" style="font-size: 1.2em;">Register</span>
				</div>

				<div id="reg-cont" style="text-align: center;">
					<div class="vcenter">
						<input id="reg-uname" class="com-input" style="text-align: center; width: 60%; margin-top: 3em;" placeholder="user name" />
						<input id="reg-passwd" class="com-input" style="text-align: center; width: 60%; margin-top: 0.5em;" placeholder="password" type="password" /><br>
						<span id="reg-create" class="com-button" style="width: 5em; margin-top: 1em;">create</span>
					</div>
				</div>
			</div>
		</div>

		<script src="foci.js"></script>
		<script src="vcent.js"></script>
		<script>
			Array.prototype.choose = function () {
				return this[Math.floor(Math.random() * this.length)];
			};

			(function () {
				var color_boxa = [ "#1ABC9C", "#2ECC71", "#3498DB", "#9B59B6", "#E67E22", "#E74C3C" ];
				var color_boxb = [ "#16A085", "#27AE60", "#2980B9", "#8E44AD", "#D35400", "#C0392B" ];

				$("#reg-main").css("background", color_boxa.choose());
			})()
		</script>
		<script>
			"use strict";

			window.onload = function () {
				var title = function (msg) {
					$("#reg-title").html(msg);
				};

				var setred = function (e) {
					e.addClass("com-input-red");
				};

				var nored = function (e) {
					e.removeClass("com-input-red");
				};

				$("#reg-uname").keydown(function () { nored($(this)); });
				$("#reg-passwd").keydown(function () { nored($(this)); });

				$("#reg-create").click(function () {
					// var orig = $("#reg-create").html();

					var uname = $("#reg-uname").val();
					var passwd = $("#reg-passwd").val();
					var err = false;

					if (!uname) {
						setred($("#reg-uname"));
						err = true;
					}

					if (!passwd) {
						setred($("#reg-passwd"));
						err = true;
					}

					if (err) return;

					$("#reg-create").html("<span class='fa fa-cog fa-spin'></span>");

					foci.newUser(uname, passwd, function (suc, dat) {
						setTimeout(function () {
							if (suc) {
								$("#reg-create").html("<span class='fa fa-check'></span>");
							} else {
								$("#reg-create").html("create");
								title(dat);
								setTimeout(function () {
									title("Register");
								}, 3000);
							}
						}, 500);
					});
				});
			};
		</script>
	</body>
</html>
